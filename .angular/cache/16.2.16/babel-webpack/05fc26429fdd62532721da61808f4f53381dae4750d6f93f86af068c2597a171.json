{"ast":null,"code":"import { TextSelection } from 'prosemirror-state';\nimport { markApplies } from 'ngx-editor/helpers';\nconst removeLink = () => {\n  return (state, dispatch) => {\n    const {\n      doc,\n      selection,\n      tr,\n      schema\n    } = state;\n    const {\n      $head: {\n        pos\n      },\n      from,\n      to\n    } = selection;\n    const linkMark = schema.marks['link'];\n    // if the cursor is on the link without any selection\n    if (from === to) {\n      const $pos = doc.resolve(pos);\n      const linkStart = pos - $pos.textOffset;\n      const linkEnd = linkStart + $pos.parent.child($pos.index()).nodeSize;\n      tr.removeMark(linkStart, linkEnd, linkMark);\n    } else {\n      tr.removeMark(from, to, linkMark);\n    }\n    if (!tr.docChanged) {\n      return false;\n    }\n    dispatch?.(tr);\n    return true;\n  };\n};\n\n// Ref: https://github.com/ProseMirror/prosemirror-commands/blob/master/src/commands.js\nconst applyMark = (type, attrs = {}) => {\n  return (state, dispatch) => {\n    const {\n      tr,\n      selection\n    } = state;\n    const {\n      empty,\n      ranges,\n      $from,\n      $to\n    } = selection;\n    if (empty && selection instanceof TextSelection) {\n      const {\n        $cursor\n      } = selection;\n      if (!$cursor || !markApplies(state.doc, ranges, type)) {\n        return false;\n      }\n      tr.addStoredMark(type.create(attrs));\n      if (!tr.storedMarksSet) {\n        return false;\n      }\n      dispatch?.(tr);\n    } else {\n      tr.addMark($from.pos, $to.pos, type.create(attrs));\n      if (!tr.docChanged) {\n        return false;\n      }\n      dispatch?.(tr.scrollIntoView());\n    }\n    return true;\n  };\n};\nconst removeMark = type => {\n  return (state, dispatch) => {\n    const {\n      tr,\n      selection,\n      storedMarks,\n      doc\n    } = state;\n    const {\n      empty,\n      ranges\n    } = selection;\n    if (empty && selection instanceof TextSelection) {\n      const {\n        $cursor\n      } = selection;\n      if (!$cursor || !markApplies(state.doc, ranges, type)) {\n        return false;\n      }\n      if (type.isInSet(storedMarks || $cursor.marks())) {\n        tr.removeStoredMark(type);\n        dispatch?.(tr);\n        return true;\n      }\n    } else {\n      for (const range of ranges) {\n        const {\n          $from,\n          $to\n        } = range;\n        const hasMark = doc.rangeHasMark($from.pos, $to.pos, type);\n        if (hasMark) {\n          tr.removeMark($from.pos, $to.pos, type);\n        }\n      }\n      if (!tr.docChanged) {\n        return false;\n      }\n      dispatch?.(tr.scrollIntoView());\n    }\n    return false;\n  };\n};\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { applyMark, removeLink, removeMark };","map":{"version":3,"names":["TextSelection","markApplies","removeLink","state","dispatch","doc","selection","tr","schema","$head","pos","from","to","linkMark","marks","$pos","resolve","linkStart","textOffset","linkEnd","parent","child","index","nodeSize","removeMark","docChanged","applyMark","type","attrs","empty","ranges","$from","$to","$cursor","addStoredMark","create","storedMarksSet","addMark","scrollIntoView","storedMarks","isInSet","removeStoredMark","range","hasMark","rangeHasMark"],"sources":["/Users/diakaria/Documents/SAITECH/ANGULAR/visitrack/node_modules/ngx-editor/fesm2022/ngx-editor-commands.mjs"],"sourcesContent":["import { TextSelection } from 'prosemirror-state';\nimport { markApplies } from 'ngx-editor/helpers';\n\nconst removeLink = () => {\n    return (state, dispatch) => {\n        const { doc, selection, tr, schema } = state;\n        const { $head: { pos }, from, to } = selection;\n        const linkMark = schema.marks['link'];\n        // if the cursor is on the link without any selection\n        if (from === to) {\n            const $pos = doc.resolve(pos);\n            const linkStart = pos - $pos.textOffset;\n            const linkEnd = linkStart + $pos.parent.child($pos.index()).nodeSize;\n            tr.removeMark(linkStart, linkEnd, linkMark);\n        }\n        else {\n            tr.removeMark(from, to, linkMark);\n        }\n        if (!tr.docChanged) {\n            return false;\n        }\n        dispatch?.(tr);\n        return true;\n    };\n};\n\n// Ref: https://github.com/ProseMirror/prosemirror-commands/blob/master/src/commands.js\nconst applyMark = (type, attrs = {}) => {\n    return (state, dispatch) => {\n        const { tr, selection } = state;\n        const { empty, ranges, $from, $to } = selection;\n        if (empty && selection instanceof TextSelection) {\n            const { $cursor } = selection;\n            if (!$cursor || !markApplies(state.doc, ranges, type)) {\n                return false;\n            }\n            tr.addStoredMark(type.create(attrs));\n            if (!tr.storedMarksSet) {\n                return false;\n            }\n            dispatch?.(tr);\n        }\n        else {\n            tr.addMark($from.pos, $to.pos, type.create(attrs));\n            if (!tr.docChanged) {\n                return false;\n            }\n            dispatch?.(tr.scrollIntoView());\n        }\n        return true;\n    };\n};\n\nconst removeMark = (type) => {\n    return (state, dispatch) => {\n        const { tr, selection, storedMarks, doc } = state;\n        const { empty, ranges } = selection;\n        if (empty && selection instanceof TextSelection) {\n            const { $cursor } = selection;\n            if (!$cursor || !markApplies(state.doc, ranges, type)) {\n                return false;\n            }\n            if (type.isInSet(storedMarks || $cursor.marks())) {\n                tr.removeStoredMark(type);\n                dispatch?.(tr);\n                return true;\n            }\n        }\n        else {\n            for (const range of ranges) {\n                const { $from, $to } = range;\n                const hasMark = doc.rangeHasMark($from.pos, $to.pos, type);\n                if (hasMark) {\n                    tr.removeMark($from.pos, $to.pos, type);\n                }\n            }\n            if (!tr.docChanged) {\n                return false;\n            }\n            dispatch?.(tr.scrollIntoView());\n        }\n        return false;\n    };\n};\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { applyMark, removeLink, removeMark };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}